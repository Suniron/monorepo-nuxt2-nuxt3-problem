CREATE VIEW public.vulnerability_has_cve AS
SELECT vu.id,
       ARRAY_TO_STRING(ARRAY_AGG(rf.value), ', ') AS cve,
       vu.name,
       vu.description,
       vu.remediation
FROM public.vulnerability as vu
         LEFT JOIN public.reference AS rf ON rf.vulnerability_id = vu.id AND rf.type = 'cve'
GROUP BY vu.id, vu.name, vu.description, vu.remediation