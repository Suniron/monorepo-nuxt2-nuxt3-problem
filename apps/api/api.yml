openapi: '3.0.2'
info:
  title: Xrator API
  version: '1.0'
servers:
  - url: /
security:
  - bearerAuth: []
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    asset:
      type: object
      properties:
        id:
          type: integer
          example: 8
        name:
          example: 10.254.1.1
        os:
          type: string
          example: Debian
        hostname:
          type: string
          format: nullable
        type:
          type: string
          example: SERVER
        ips:
          type: array
          items:
            type: object
            properties:
              id:
                type: integer
                example: 7
              address:
                type: string
                example: 10.254.1.1
              mac:
                type: string
                format: nullable
              iface:
                type: string
                format: nullable
              mask:
                type: string
                format: nullable
        url:
          type: string
          format: nullable
        language:
          type: string
          format: nullable
        position:
          type: string
          format: nullable
        mail:
          type: string
          format: nullable
        tel:
          type: string
          format: nullable
        location:
          type: string
          format: nullable
        low_vulnerabilities:
          type: string
          example: 4
        medium_vulnerabilities:
          type: string
          example: 22
        high_vulnerabilities:
          type: string
          example: 2
        critical_vulnerabilities:
          type: string
          example: 0
        tags:
          type: array
          items:
            type: object
            properties:
              id:
                type: integer
                example: 6
              name:
                type: string
                example: LDC
              color:
                type: string
                example: #BA55D3
        groups:
          type: array
          items:
            type: object
            properties:
              id:
                type: integer
                example: 2
              name:
                type: string
                example: France
        sitemap:
          type: array
          items:
            type: object
            properties:
              uri:
                type: string
                example: /webtemp/jsloader-ed288164b937.js
        relations:
          type: array
          items:
            type: object
            properties:
              id:
                type: integer
                example: 8
              rel_id:
                type: integer
                example: 54
              type:
                type: string
                example: BELONGS_TO
              name:
                type: string
                example: INTERNAL
              to_id:
                type: integer
                example: 44
        revision:
          type: string
          format: nullable
        rev_cdate:
          type: string
          format: nullable
        netmask:
          type: string
          format: nullable
        gateway:
          type: string
          format: nullable
        network:
          type: string
          format: nullable
        latitude:
          type: string
          format: nullable
        longitude:
          type: string
          format: nullable
        total_count:
          type: string
          example: 1
    compliance_list:
      type: object
      properties:
        compliance:
          type: string
          example: ISO 27001
    compliance_details:
      type: object
      properties:
        id:
          type: integer
          example: 10
        compliance:
          type: string
          example: "ISO 27001"
        chapter:
          type: string
          example: "Access Control"
        chapter_small:
          type: string
          example: ISO Chapter A.9
        title:
          type: string
          example: "User access provisioning"
        section:
          type: string
          example: "A.9.2.2"
        description:
          type: string
          example: "A formal user access provisioning process shall be implemented to assign or revoke user access rights to systems and services."
        non_existant_risk:
          type: string
          example: "High"
        inneffective_risk:
          type: string
          example: "Medium"
        partially_effective_risk:
          type: string
          example: "Low"
        effective_risk:
          type: string
          example: "Ok"
        docs:
          type: string
        asset_id:
          type: integer
          example: 32
        name:
          type: string
          example: "ISO 27001 / Access Control / User access provisioning"
        compliance_id:
          type: integer
          example: 10
        status:
          type: string
          example: "Medium"
        mitigation:
          type: string
          example: "No user"
        residual_risk:
          type: string
          example: "Ok"
        response:
          type: array
          items:
            type: object
            properties:
              text:
                type: String
                example: "Non Existant"
              value:
                type: String
                example: "High"
    compliance_stats:
      type: object
      properties:
        chapter: 
          type: string
          example: "Access Control"
        chapter_small: 
          type: string
          example: "ISO Chapter A.9"
        completion:
          type: number
          example: 8.3
        maturity:
          type: number
          example: 5.3
    vulnerability:
      type: object
      properties:
        id:
          type: integer
          example: 1
        type:
          type: string
          example: vulnerability
        baseline:
          type: string
          format: nullable
        oid:
          type: string
          format: nullable
        burpId:
          type: integer
          example: 16777728
        name:
          type: string
          example: Unencrypted communications
        description:
          type: string
          example: The application
        remediation:
          type: string
          example: Applications should use transport-level encryption (SSL/TLS).
        insight:
          type: string
          format: nullable
        affected:
          type: string
          format: nullable
        vulndetect:
          type: string
          format: nullable
        clusterId:
          type: integer
          example: 205
        affectedAssets:
          type: array
          items:
            type: object
            properties:
              vastId:
                type: integer
                example: 3
              assetType:
                type: string
                example: "NETWORK"
              id:
                type: integer
                example: 15
              name:
                type: string
                example: 111
              cvssScore:
                type: number
                example: 6
              status:
                type: string
                example: "open"
              severity:
                type: string
                example: medium
              projects:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                      example: 1
                    name:
                      type: string
                      example: "Default project"
            required:
              - id
              - vastId
              - name
              - assetType
      required:
        - id
        - type
        - baseline
        - oid
        - burpId
        - name
        - description
        - remediation
        - insight
        - affected
        - vulndetect
        - affectedAssets
    scan:
      type: object
      properties:
        id:
          type: integer
          example: 1
        company_id:
          type: integer
          example: 1
        probe_id:
          type: integer
          example: 1
        name:
          type: string
          example: "Scan discovery"
        cdate:
          type: string
          example: "2022-04-01 15:56:30.728 +0200"
        sdate:
          type: string
          example: "2022-04-02 02:00:00.052 +0200"
        fdate:
          type: string
          example: "2022-04-02 13:55:00.052 +0200"
        start_date:
          type: string
          example: "2022-04-01"
        end_date:
          type: string
          example: "2022-04-02"
        start_time:
          type: string
          example: "01:00:00 +0100"
        end_time:
          type: string
          example: "02:01:00 +0100"
        scan_type:
          type: string
          example: "nmap"
        container_id:
          type: integer
          example: 1
        parameters:
          type: string
          example: '{"assets":[{"address":"10.254.1.5"}],"credentials":[]}'
        status:
          type: string
          example: completed
    remediation_project_summary:
      type: object
      properties:
        project_id:
          type: integer
          example: 1
        project_name:
          type: string
          example: "Project name"
        owner_id:
          type: string
          example: "3381af4c-8690-496b-a086-b346e9fbc1bc"
        owner_name:
          type: string
          example: "Owner name"
        priority:
          type: string
          example: "high"
        priority_weight:
          type: integer
          example: 1
        status:
          type: string
          example: "open"
        status_weight:
          type: integer
          example: 1
        due_date:
          type: string
          example: "2022-06-01T12:20:00Z"
        start_date:
          type: string
          example: "2022-06-01T13:20:00Z"
        is_overdue:
          type: boolean
          example: true
        company_id:
          type: integer
          example: 1
      required:
        - project_id
        - project_name
        - owner_id
        - owner_name
        - priority
        - priority_weight
        - status
        - status_weight
        - due_date
        - is_overdue
        - company_id
    remediation_project_details:
      type: object
      properties:
        project_id:
          type: integer
          example: 1
        project_name:
          type: string
          example: "Project name"
        project_description:
          type: string
          example: "Remediation project description"
        owner_id:
          type: string
          example: "3381af4c-8690-496b-a086-b346e9fbc1bc"
        owner_name:
          type: string
          example: "Owner name"
        assignees:
          type: array
          items:
            type: object
            properties:
              user_id:
                type: string
                example: "3381af4c-8690-496b-a086-b346e9fbc1bc"
              username:
                type: string
                example: "Joe"
        priority:
          type: string
          example: "high"
        status:
          type: string
          example: "open"
        status_id:
          type: integer
          example: 1
        status_weight:
          type: integer
          example: 1
        creation_date:
          type: string
          example: "2022/06/01 10:30:00"
        start_date:
          type: string
          example: "2022/06/10 00:00:00"
        due_date:
          type: string
          example: "2022/08/01 00:00:00"
        is_overdue:
          type: boolean
          example: true
      required:
        - project_id
        - project_name
        - project_description
        - owner_id
        - owner_name
        - assignees
        - priority
        - status
        - status_id
        - status_weight
        - creation_date
        - due_date
        - is_overdue
    remediation_project_details_edit:
      type: object
      properties:
        project_name:
          type: string
          example: "Project name"
        project_description:
          type: string
          example: "Remediation project description"
        owner_id:
          type: string
          example: "3381af4c-8690-496b-a086-b346e9fbc1bc"
        assignees:
          type: array
          items:
            type: string
            example: "3381af4c-8690-496b-a086-b346e9fbc1bc"
        priority:
          type: string
          example: "high"
        status_id:
          type: integer
          example: 1
        due_date:
          type: string
          example: "2022/08/01 00:00:00"
    remediation_project_details_create:
      type: object
      properties:
        name:
          type: string
          example: "Project name"
        description:
          type: string
          example: "Remediation project description"
        owner:
          type: string
          example: "3381af4c-8690-496b-a086-b346e9fbc1bc"
        priority:
          type: string
          example: "high"
        start_date:
          type: string
          example: "2022-06-01T13:20:00Z"
        due_date:
          type: string
          example: "2022-06-01T12:20:00Z"
        assignees:
          type: array
          items:
            type: string
            example: "3381af4c-8690-496b-a086-b346e9fbc1bc"
        project_scope:
          description: 'List of vulnerability_asset_id'
          type: array
          items:
            type: integer
            example: 90
      required:
        - project_name
        - project_description
        - owner
        - assignees
        - start_date
        - priority
        - due_date
        - project_scope
    remediation_project_scope:
      type: object
      properties:
        project_id:
          type: number
          example: 1
        project_scope_id:
          type: integer
          example: 1
        vulnerability_asset_id:
          type: integer
          example: 1
        asset_id:
          type: integer
          example: 1
        asset_type:
          type: string
          example: "SERVER"
        asset_name:
          type: string
          example: "10.254.10.2"
        vulnerability_id:
          type: integer
          example: 1
        vulnerability_name:
          type: string
          example: "Debian LTS: Security Advisory for apt (DLA-2487-1)"
        severity:
          type: string
          example: "low"
        remediation:
          type: string
          example: "For Debian 9 stretch, this problem has been fixed in version1.4.11.\n\nWe recommend that you upgrade your apt packages."
        is_done:
          type: boolean
          example: true
      required:
        - project_scope_id
        - asset_name
        - is_done
    remediation_project_details_status_history:
      type: object
      properties: 
        project_id: 
          type: integer
          example: 1
        user_id: 
          type: string
          example: "3381af4c-8690-496b-a086-b346e9fbc1bc"
        user_name: 
          type: string
          example: "Etienne Blanc"
        from_date:
          type: string
          example: "2022/06/03 10:34:20"
        from_status_name :
          type: string
          example: "to_review"
        to_status_name:
          type: string
          example: "in_progress"
        comment:
          type: string
          example: "The remediation is not fully completed"
      required:
        - project_id
        - user_id
        - user_name
        - from_date
        - from_status_name
        - to_status_name
    project_transition:
      type: object
      properties:
        project_status_workflow_id:
          type: integer
          example: 1
        transition:
          type: string
          example: "refuse"
        from_status_id:
          type: integer
          example: 2
        from_status_name:
          type: string
          example: "to_review"
        to_status_id:
          type: integer
          example: 3
        to_status_name:
          type: string
          example: "in_progress"
      required:
        - project_status_workflow_id
        - transition
        - from_status_id
        - from_status_name
        - to_status_id
        - to_status_name
    posts_remediation_project :
      type: object
      properties:
        comment_id:
          type: integer
          example : 1
        from_date: 
          type : string
          example : "2022/06/03 10:34:20"
        user_id: 
          type: string
          example: "3381af4c-8690-496b-a086-b346e9fbc1bc"
        user_name: 
          type: string
          example: "Etienne Blanc"
        comment: 
          type: string
          example : "I'll remediate it in no time !"
        from_status_name:
          type: string 
          example: "open"
        to_status_name:
          type: string 
          example: "in_progress"
    remediation_project_scope_edit:
      type: object
      properties:
        project_scope:
          type: array
          items:
            type: integer
            example: 90
    remediation_project_scope_item_edit:
      type: object
      properties:
        is_done:
          type: boolean
          example: true
      required:
        - is_done
paths:
  /assets:
    get:
      security:
        - bearerAuth: []
      tags:
        - 'Asset'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  total:
                    type: string
                    example: '74'
                  assets:
                    type: array
                    items:
                      $ref: '#/components/schemas/asset'
      summary: Get assets
      parameters:
        - in: query
          name: ids
          schema:
            type: string
            example: 68,69
          description: The IDs of assets to get
        - in: query
          name: types
          schema:
            type: object
            properties:
              types:
                type: string
                example: SERVER,WEB,USER,BUILDING,NETWORK
              page:
                type: string
                example: 1
              pageSize:
                type: string
                example: 20
          required: true
          description: Numeric ID of the asset to get
    patch:
      tags:
        - 'Asset'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  example: 10.254.1.1
                type:
                  type: string
                  example: SERVER
                assets:
                  type: array
                  items:
                    type: integer
                    example: 4
                assetData:
                  type: object
                  properties:
                    os:
                      type: string
                      example: Ubuntu
                    OWN_BY:
                      type: array
                      items:
                        type: integer
                        example: 28
                    MAINTAINED_BY:
                      type: array
                      items:
                        type: integer
                        example: 30
                    LOCATED_TO:
                      type: integer
                      example: 17
                tagIds:
                  type: array
                  items:
                    type: integer
                    example: 15
                groupIds:
                  type: array
                  items:
                    type: integer
                    example: 2
        required: true
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      failed:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              example: 4
                            error:
                              type: string
                              example: ModelError
      summary: Edit multiple assets
      security:
        - bearerAuth: []
    delete:
      tags:
        - 'Asset'
      description: ''
      summary: Delete multiple assets
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                assets:
                  type: array
                  items:
                    type: integer
                    example: 2
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: SUCCESS
    post:
      tags:
        - 'Asset'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: SUCCESS
      summary: Create an asset
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  format: nullable
                type:
                  type: string
                  example: SERVER
                assets:
                  type: array
                  items:
                    type: integer
                    example: 4
                assetData:
                  type: object
                  properties:
                    os:
                      type: string
                      example: Windows
                    OWN_BY:
                      type: array
                      items:
                        type: integer
                        example: 29
                    MAINTAINED_BY:
                      type: array
                      items:
                        type: integer
                        example: 29
                    LOCATED_TO:
                      type: integer
                      example: 20
                tagIds:
                  type: array
                  items:
                    type: integer
                    example: 4
                groupIds:
                  type: array
                  items:
                    type: integer
                    example: 2
        required: true
  /assets/summary:
    get:
      security:
        - bearerAuth: []
      tags:
        - "Asset"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  USER:
                    type: number
                    example: 74
                  SERVER:
                    type: number
                    example: 74
                  WEB:
                    type: number
                    example: 74
                  BUILDING:
                    type: number
                    example: 74
                  NETWORK:
                    type: number
                    example: 74
                  UNIT:
                    type: number
                    example: 74
                  MISSION:
                    type: number
                    example: 74
                  USERGROUP:
                    type: number
                    example: 74
                  POLICY:
                    type: number
                    example: 74
                  COMPLIANCE:
                    type: number
                    example: 74
                  PROCEDURE:
                    type: number
                    example: 74
                  superAssets:
                    type: number
                    example: 74
                  technicalAssets:
                    type: number
                    example: 74
      summary: Get asset summary
  /assets/{assetId}:
    get:
      tags:
        - 'Asset'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/asset'
      summary: Get a single asset
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: assetId
          schema:
            type: integer
          required: true
          description: Numeric ID of the asset to get
    patch:
      tags:
        - 'Asset'
      responses:
        '204':
          description: No Content
      summary: Edit asset
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: assetId
          schema:
            type: integer
          required: true
          description: Numeric ID of the asset to get
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  example: 10.254.1.1
                type:
                  type: string
                  example: SERVER
                assetData:
                  type: object
                  properties:
                    name:
                      type: string
                      example: 10.254.1.1
                    os:
                      type: string
                      example: Windows
                    IPs:
                      type: array
                      items:
                        type: object
                        properties:
                          id:
                            type: integer
                            example: 7
                          address:
                            type: string
                            example: 10.254.1.1
                          mac:
                            type: string
                            format: nullable
                          iface:
                            type: string
                            format: nullable
                          mask:
                            type: string
                            format: nullable
                    OWN_BY:
                      type: array
                      items:
                        type: integer
                        example: 29
                    MAINTAINED_BY:
                      type: array
                      items:
                        type: integer
                        example: 29
                    LOCATED_TO:
                      type: integer
                      example: 20
        required: true
    delete:
      tags:
        - 'Asset'
      description: ''
      summary: Delete a single asset
      security:
        - bearerAuth: []
      responses:
        '204':
          description: No Content
      parameters:
        - in: path
          name: assetId
          schema:
            type: integer
          required: true
          description: Numeric ID of the asset to get

  /assets/belonging:
    get:
      tags:
        - "Asset"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                      example: 8
                    name:
                      type: string
                      example: "Example Asset"
                    type:
                      type: string
                      example: "SERVER"
                    children_ids:
                      type: array
                      items:
                        type: integer
                        example: 7
                    parents_ids:
                      type: array
                      items:
                        type: integer
                        example: 9
                    risk:
                      type: object
                      properties:
                        lastScanDate:
                          type: string
                          nullable: true
                          example: "2020-01-01T00:00:00.000Z"
                        scores:
                          compoundScore:
                            type: number
                            example: 3.2
                            nullable: true
                          inherentScore:
                            type: number
                            example: 3.2
                            nullable: true
                          inheritedScore: 
                            type: number
                            example: 3.2
                            nullable: true
      parameters:
        - in: query
          name: parents_ids
          schema:
            type: string
            example: "8,9"
          description: The ids of the parent assets whose children are returned
        - in: query
          name: children_ids
          schema:
            type: string
            example: "8,9"
          description: The ids of the child assets whose parents are returned
  /assets/importCSV:
    post:
      tags:
        - 'Asset'
      responses:
        '200':
          description: OK
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                headers:
                  type: array
                  items:
                    type: object
                    properties:
                      key:
                        type: string
                        example: name
                      csv:
                        type: array
                        items:
                          type: integer
                          example: 0
                data:
                  type: array
                  items:
                    type: array
                    items:
                      type: string
                      example: 'test'
  /assets/{assetId}/vulnerabilities:
    get:
      tags:
        - 'Asset'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  vulnerabilities:
                    type: array
                    items:
                      type: object
                      properties:
                        vulnerabilityId:
                          type: integer
                          format: int32
                          example: 92
                        name:
                          type: string
                          example: Missing Linux Kernel mitigations for 'L1TF - L1 Terminal Fault' hardware vulnerabilities
                        description:
                          type: string
                          example: The remote host is missing one or more known mitigation(s) on Linux Kernel  side for the referenced 'L1TF - L1 Terminal Fault' hardware vulnerabilities.
                        remediation:
                          type: string
                          example: Enable the mitigation(s) in the Linux Kernel or update to a more  recent Linux Kernel.
                        insight:
                          type: string
                          format: nullable
                        affected:
                          type: string
                          format: nullable
                        vulndetect:
                          type: string
                          example: Checks previous gathered information on the mitigation status reported  by the Linux Kernel.
                        details:
                          type: array
                          items:
                            type: object
                            properties:
                              vast_id:
                                type: integer
                                format: int32
                                example: 200
                              details:
                                type: string
                                example: The Linux
                              custom_description:
                                type: string
                                format: nullable
                              custom_remediation:
                                type: string
                                format: nullable
                              cvss_code:
                                type: string
                                example: AV:L/AC:M/Au:N/C:C/I:P/A:N
                              cvss_score:
                                type: number
                                example: 5.4
                              severity:
                                type: string
                                example: medium
                              confidence:
                                type: string
                                format: nullable
                              likelihood:
                                type: string
                                format: nullable
                              status:
                                type: string
                                format: nullable
                              ip:
                                type: string
                                example: 10.254.1.13
                              port:
                                type: integer
                                format: int32
                                example: 0
                              protocol:
                                type: string
                                example: tcp
                              vuln_publication_date:
                                type: string
                                format: nullable
                              uri:
                                type: string
                                format: nullable
                        cvss:
                          type: object
                        refs:
                          type: array
                          items:
                            type: object
                            properties:
                              type:
                                type: string
                                example: url
                              value:
                                type: string
                                example: https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/l1tf.html
                        cves:
                          type: array
                          items:
                            type: object
                            properties:
                              type:
                                type: string
                                example: cve
                              value:
                                type: string
                                example: CVE-2018-3615
                  total:
                    type: integer
                    format: int32
                    example: 11

      summary: Get the vulnerabilities linked to a specific asset
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: assetId
          schema:
            type: integer
          required: true
          description: Numeric ID of the asset to get
    patch:
      tags:
        - 'Asset'
      responses:
        '204':
          description: No Content
      summary: Edit the vulnerabilities linked to a specific asset
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: assetId
          schema:
            type: integer
          required: true
          description: Numeric ID of the asset to get
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                vulnId:
                  type: object
                  properties:
                    id:
                      type: integer
                      example: 7
                    oid:
                      type: string
                      format: nullable
                    burpId:
                      type: string
                      format: nullable
                    name:
                      type: string
                      example: bbbbbbbbbbbbbbbbbbbb
                    description:
                      type: string
                      example: bbbbbbbbbbbbbbbbbb
                    remediation:
                      type: string
                      example: bbbbbbbbbbbbbbbbb
                    insight:
                      type: string
                      example:
                    affected:
                      type: string
                      example:
                    vulndetect:
                      type: string
                      example:
                    affectedAssets:
                      type: string
                      format: nullable
                vulnerability_id:
                  type: integer
                  example: 7
                name:
                  type: string
                  example: bbbbbbbbbbbbbbbbbbbb
                description:
                  type: string
                  example: bbbbbbbbbbbbbbbbbb
                remediation:
                  type: string
                  example: bbbbbbbbbbbbbbbbb
                details:
                  type: string
                  example: aaaa
                code:
                  type: string
                  example: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:L/I:L/A:L
                score:
                  type: integer
                  example: 4.6
                version:
                  type: integer
                  example: 3.1
                ips:
                  type: array
                  items:
                    type: object
                    properties:
                      id:
                        type: string
                        example: b3d24008-ed46-4bc6-a9c7-788172f8b868
                      ip_id:
                        type: integer
                        example: 18
                      address:
                        type: string
                        example: 1.1.01.1
                      ports:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              example: 3
                            integer:
                              type: integer
                              example: 139
                            protocol:
                              type: string
                              example: tcp
        required: true
  /assets/{assetId}/risk:
    get:
      tags:
        - "Asset"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  lastScanDate:
                    type: string
                    nullable: true
                    example: "2021-01-02 03:00:00.000Z"
                  scores:
                    type: object
                    properties:
                      inherentScore:
                        type: number
                        nullable: true
                        example: 7.1
                      inheritedScore:
                        type: number
                        nullable: true
                        example: 8.7
                      compoundScore:
                        type: number
                        nullable: true
                        example: 8.5
      summary: Get the risks of a specific asset
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: assetId
          schema:
            type: integer
          required: true
          description: Numeric ID of the asset to get
  /assets/{assetId}/vulnerabilities/{vid}:
    post:
      tags:
        - 'Asset'
      responses:
        '204':
          description: No Content
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                updated:
                  type: string
                  example: Accepted
                comment:
                  type: string
                  example: It is good for me.
      summary: Set the asset's vulnerability state
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: assetId
          schema:
            type: integer
          required: true
          description: Numeric ID of the asset to get
        - in: path
          name: vid
          schema:
            type: integer
          required: true
          description: Numeric ID of the vulnerability to get
  /vulnerabilities_asset/{vastId}:
    patch:
      tags:
        - 'Asset'
      responses:
        '200':
          description: OK
          content:
            properties:
              example: Changements effectués
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: assetId
          schema:
            type: integer
          required: true
          description: Numeric ID of the asset to get
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                vuln:
                  type: object
                  properties:
                    vast_id:
                      type: integer
                      format: int32
                      example: 1
                    details:
                      type: string
                      example: <p>Thomas</p>
                    custom_description:
                      type: string
                      example: <p>The Adobe Flash Player on the remote host has reached the End of Life (EOL) / is discontinued and should not be used anymore.</p>
                    custom_remediation:
                      type: string
                      example: <p>No solution was made available by the vendor. General solution options are to upgrade to a newer release disable respective features remove the product or replace the product by another one.\n\n Note The product has reached its EOL.</p>
                    cvss_code:
                      type: string
                      example: CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:C/C:L/I:N/A:N
                    cvss_score:
                      type: number
                      example: 3.4
                    severity:
                      type: string
                      example: medium
                    confidence:
                      type: string
                      example:
                    likelihood:
                      type: string
                      example:
                    status:
                      type: string
                      example: open
                    ip:
                      type: string
                      example: 1.0.0.1
                    port:
                      type: integer
                      format: int32
                      example: 139
                    protocol:
                      type: string
                      example: tcp
                    vuln_publication_date:
                      type: string
                      example:
                    uri:
                      type: string
                      format: nullable
                    score:
                      type: number
                      example: 3.4
                    code:
                      type: string
                      example: CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:C/C:L/I:N/A:N
                    version:
                      type: number
                      example: 3.1
    delete:
      tags:
        - 'Asset'
      responses:
        '200':
          description: OK
          content:
            properties:
              example: Changements effectués
      parameters:
        - in: path
          name: vastId
          schema:
            type: integer
          required: true
          description: Numeric ID of the vulnerabilities asset

  /assets/{assetId}/revisions:
    get:
      tags:
        - 'Asset'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  revisions:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          example: 3
                        asset_document_id:
                          type: integer
                          example: 139
                        revision:
                          type: string
                          example: v1.0
                        cdate:
                          type: string
                          example: 2022-04-13
                        store_id:
                          type: integer
                          example: 10
                  total:
                    type: integer
                    example: 0

      summary: Get the revisions of an asset
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: assetId
          schema:
            type: integer
          required: true
          description: Numeric ID of the asset to get
  /assets/{assetId}/ports:
    get:
      tags:
        - 'Asset'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  details:
                    type: array
                    items:
                      type: object
                      properties:
                        ip_id:
                          type: integer
                          example: 18
                        ast_id:
                          type: integer
                          example: 15
                        address:
                          type: string
                          example: 1.1.01.1
                        id:
                          type: integer
                          example: 3
                        cpe_id:
                          type: string
                          format: nullable
                        integer:
                          type: integer
                          example: 139
                        version:
                          type: string
                          example:
                        service:
                          type: string
                          example:
                        protocol:
                          type: string
                          example: tcp
                        detail:
                          type: string
                          example:
                        status:
                          type: string
                          example: open
      summary: Get the port of an asset
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: assetId
          schema:
            type: integer
          required: true
          description: Numeric ID of the asset to Get
  /login/password:
    post:
      tags:
        - 'Login'
      responses:
        '201':
          description: 'Created'
          content:
            application/json:
              schema:
                type: object
                properties:
                  accessToken:
                    type: string
                    example: 'R5cCI6IkpXVCJ9'
                  user:
                    type: object
                    properties:
                      id:
                        type: string
                        example: 'e2a-7bd5a-416'
                      firstname:
                        type: string
                        example: 'admin'
                      lastname:
                        type: string
                        example: 'Admin'
                      username:
                        type: string
                        example: 'admin'
                      email:
                        type: string
                        example: 'admin@user.com'
                      companyId:
                        type: integer
                        example: 1
                      companyName:
                        type: string
                        example: 'enterprise'
                      roles:
                        type: array
                        example: ['admin']
      summary: Login to the app
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                  example: 'admin'
                password:
                  type: string
                  example: 'P@ssw0rd1234'
  /refresh-token:
    post:
      tags:
        - 'Login'
      responses:
        '201':
          description: 'Created'
          content:
            application/json:
              schema:
                type: object
                properties:
                  accessToken:
                    type: string
                    example: 'R5cCI6IkpXVCJ9'
                  user:
                    type: object
                    properties:
                      id:
                        type: string
                        example: 'e2a-7bd5a-416'
                      firstname:
                        type: string
                        example: 'admin'
                      lastname:
                        type: string
                        example: 'Admin'
                      username:
                        type: string
                      email:
                        type: string
                        example: 'admin@user.com'
                      companyId:
                        type: integer
                        example: 1
                      companyName:
                        type: string
                        example: 'enterprise'
                      roles:
                        type: array
                        example: ['admin']
                      groups:
                        type: array
                        example: ['France']
      summary: Refresh token
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                  example: 'admin'
                password:
                  type: string
                  example: 'P@ssw0rd1234'

  /logout:
    delete:
      tags:
        - 'Login'
      responses:
        '204':
          description: 'No Content'
      summary: Logout to the app
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                accessToken:
                  type: string
                  example: 'R5cCI6IkpXVCJ9'
                user:
                  type: object
                  properties:
                    id:
                      type: string
                      example: 'e2a-7bd5a-416'
                    firstname:
                      type: string
                      example: 'admin'
                    lastname:
                      type: string
                      example: 'Admin'
                    username:
                      type: string
                    email:
                      type: string
                      example: 'admin@user.com'
                    companyId:
                      type: integer
                      example: 1
                    companyName:
                      type: string
                      example: 'enterprise'
                    roles:
                      type: array
                      example: ['admin']
                    groups:
                      type: array
                      example: ['France']
  /assets/{assetId}/vulnerabilities/{vid}/post:
    get:
      tags:
        - 'Asset'
      responses:
        '200':
          description: Ok
          content:
            application/json:
              schema:
                type: object
                properties:
                  comments:
                    type: array
                    items:
                      type: object
                      properties:
                        commentId:
                          type: integer
                          example: 1
                        vulnId:
                          type: integer
                          example: 1
                        comment:
                          type: string
                          example: <p>Would it be possible to install our x509 certificate on this Web service?</p><p><br></p></p>
                        createdAt:
                          type: string
                          example: '2021-09-28T03:50:36.149Z'
                        firstName:
                          type: string
                          example: Super
                        lastName:
                          type: string
                          example: Admin
                  total:
                    type: integer
                    example: 1
      summary: Get all comments from a specific asset's vulnerability
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: assetId
          schema:
            type: integer
          required: true
          description: Numeric ID of the asset to get
        - in: path
          name: vid
          schema:
            type: integer
          required: true
          description: Numeric ID of the vulnerability to get
    post:
      tags:
        - 'Asset'
      responses:
        '204':
          description: No Content
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                comment:
                  type: string
                  example: '<p>Would it be possible to install our x509 certificate on this Web service?</p>'
      summary: Post a comment linked to a specific asset's vulnerability
      security:
        - bearerAuth: []
    parameters:
      - in: path
        name: assetId
        schema:
          type: integer
        required: true
        description: Numeric ID of the asset to get
      - in: path
        name: vulnerabilitieId
        schema:
          type: integer
        required: true
        description: Numeric ID of the vulnerability to get
  /posts:
    get:
      tags:
        - 'Blog'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  posts:
                    type: array
                    items:
                      type: object
                      properties:
                        vast_id:
                          type: integer
                          example: 1
                        type:
                          type: string
                          example: WEB
                        ast_id:
                          type: integer
                          example: 1
                        name:
                          type: string
                          example: test.x-rator.com
                        vuln_name:
                          type: string
                          example: Unencrypted communications
                        comment:
                          type: string
                          example: <p>Would it be possible to install our x509 certificate on this Web service
                        created_at:
                          type: string
                          example: 2021-02-12T03:54:02.446Z
                  total:
                    type: integer
                    example: 4

      summary: Get all comments from all assets's vulnerabilities
      security:
        - bearerAuth: []
  
  /projects/available-transitions:
   get: 
      tags:
        - "Project Management"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/project_transition"
      summary: Get availables transitions from a specific status
      security:
        - bearerAuth: []
  /projects/available-transitions/{statusId}:
    get: 
      tags:
        - "Project Management"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/project_transition"
      summary: Get availables transitions from a specific status
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: statusId
          schema:
            type: integer
            example: 2
          required: true
          description: Numeric ID of the status for which to get available transition

  /posts/remediation-project/{id}:
    get:
      tags:
        - "Blog"
        - "Remediation Project"
      responses: 
        "200":
          description : OK 
          content: 
            application/json:
              schema: 
                type: array
                items:
                  $ref: "#/components/schemas/posts_remediation_project"
      summary: Get all comments of a remediation project
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
            example: 1
          required: true
          description: Numeric ID of the remediation project
    post:
      tags:
        - "Blog"
        - "Remediation Project"
      parameters:
        - in: path
          name: id
          schema:
            type: string
            example: 1
          required: true
          description: Numeric ID of the remediation project
      requestBody:
        content:
          application/json:
            schema:
              oneOf:
                - type: object
                  properties:
                    comment:
                      type: string
                      example: "<p>I am a <b>great<b> <i>comment</i></p>"
                    project_status_history_id:
                      type: integer
                      example: 2
                  required:
                    - comment
                    - project_status_history_id
                - type: object
                  properties:
                    comment:
                      type: string
                      example: "<p>I am a <b>great<b> <i>comment</i></p>"
                  required:
                    - comment
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    example: 2

  /cartographies:
    get:
      tags:
        - 'Cartographie'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  cartographies:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          example: 1
                        name:
                          type: string
                          example: MAIN

      summary: Get all cartographies linked to a specific user
      security:
        - bearerAuth: []
    post:
      tags:
        - 'Cartographie'
      responses:
        '200':
          description: Return the new cartography's id
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    example: 1
      summary: Create a new cartography
      security:
        - bearerAuth: []
  /cartographies/{cartoId}:
    patch:
      tags:
        - 'Cartographie'
      responses:
        '200':
          description: OK
      summary: Edit a single cartography
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  example: R&D department
      parameters:
        - in: path
          name: cartoId
          schema:
            type: integer
          required: true
          description: Numeric ID of the cartographie to get
    get:
      tags:
        - 'Cartographie'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  elements:
                    type: array
                    items:
                      type: object
                      properties:
                        group:
                          type: string
                          example: nodes
                        data:
                          type: object
                          properties:
                            id:
                              type: integer
                              format: int32
                              example: 347
                            name:
                              type: string
                              example: a
                            type:
                              type: string
                              example: server
                            parent:
                              type: string
                              format: nullable
                            asset_id:
                              type: integer
                              format: int32
                              example: 179
                        position:
                          type: object
                          properties:
                            x:
                              type: number
                              example: 121.61432354661608
                            y:
                              type: number
                              example: -14.700274505022108
                        classes:
                          type: string
                          example: server

      summary: Get a single cartography
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: cartoId
          schema:
            type: integer
          required: true
          description: Numeric ID of the cartographie to get
    delete:
      tags:
        - 'Cartographie'
      responses:
        '200':
          description: OK
      summary: Delete a single cartography
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: cartoId
          schema:
            type: integer
          required: true
          description: Numeric ID of the cartographie to get
  /cartographies/{cartoId}/elements:
    post:
      tags:
        - 'Cartographie'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    example: 10
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                asset_id:
                  type: integer
                  example: 35
                cygroup:
                  type: string
                  example: nodes
      summary: Create an element for a specific cartography
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: cartoId
          schema:
            type: integer
          required: true
          description: Numeric ID of the cartographie to get
  /cartographies/{cartoId}/elements/{eId}:
    patch:
      tags:
        - 'Cartographie'
      responses:
        '200':
          description: OK
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                x:
                  type: number
                  example: 186.95784233295737
                y:
                  type: number
                  example: 112.97452504611863

      summary: Edit a single element of a specific cartography
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: cartoId
          schema:
            type: integer
          required: true
          description: Numeric ID of the cartographie to get
        - in: path
          name: eId
          schema:
            type: integer
          required: true
          description: Numeric ID of the cartographie's element
    delete:
      tags:
        - 'Cartographie'
      responses:
        '200':
          description: OK
      summary: Delete a single element of a specific cartography
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: cartoId
          schema:
            type: integer
          required: true
          description: Numeric ID of the cartographie to get
        - in: path
          name: eId
          schema:
            type: integer
          required: true
          description: Numeric ID of the cartographie's element
  /company:
   patch:
      tags:
        - "Company"
      responses:
        "204":
          description: OK
      summary: Edit the logged user company
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                selectedDomain:
                  type: integer
                  example: 1
  /company/risk:
    get:
      tags:
        - "Company"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  globalScore:
                    type: number
                    nullable: true
                    example: 5.5
      summary: Get the global company risk
      security:
        - bearerAuth: []
  /company/logo:
    get:
      tags:
        - 'Company'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  logo:
                    type: string
                    example: 'data:image/png;base64,........'
      summary: Get the logged user company's logo
      security:
        - bearerAuth: []
    patch:
      tags:
        - 'Company'
      responses:
        '204':
          description: OK
      summary: Edit the logged user company's logo
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                logo:
                  type: string
                  example: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAA1JREFUGFdj4IuO/g8AAwMBxOiDqfIAAAAASUVORK5CYII='
    delete:
      tags:
        - 'Company'
      responses:
        '204':
          description: OK
      summary: Delete the logged user company's logo
      security:
        - bearerAuth: []
  /companies:
    patch:
      tags:
        - 'Company'
      responses:
        '204':
          description: OK
      summary: Edit the logged user company's logo
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                logo:
                  type: string
                  example: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAA1JREFUGFdj4IuO/g8AAwMBxOiDqfIAAAAASUVORK5CYII='
    delete:
      tags:
        - 'Company'
      responses:
        '204':
          description: OK
      summary: Delete the logged user company's logo
      security:
        - bearerAuth: []
    get:
      tags:
        - 'Company'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  companies:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          example: 8
                        name:
                          type: string
                          example: xrator
                        logo:
                          type: string
                          example: 'data:image/png;base64,........'
                  total:
                    type: integer
                    example: 1
      summary: Get all companies
      security:
        - bearerAuth: []
    post:
      tags:
        - 'Company'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    example: 9
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  example: 'Ronintel'
        required: true
      summary: Create a company
      security:
        - bearerAuth: []
  /companies/{cid}:
    get:
      tags:
        - 'Company'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    example: 8
                  name:
                    type: string
                    example: xrator

      summary: Get a single company
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: cid
          schema:
            type: integer
          required: true
          description: Numeric ID of the company
  /dashboard:
    get:
      tags:
        - 'Dashboard'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  severitiesSummary:
                    type: object
                    properties:
                      severitiesSummary:
                        type: object
                        properties:
                          low:
                            type: integer
                            example: 36
                          medium:
                            type: integer
                            example: 130
                          high:
                            type: integer
                            example: 37
                          critical:
                            type: integer
                            example: 9
                      global:
                        type: integer
                        example: 42
                      topVulnerabilities:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              example: 13
                            name:
                              type: string
                              example: Backup file
                            ocurrences:
                              type: integer
                              example: 19
                            percent:
                              type: integer
                              example: 7
                      likelihoods:
                        type: object
                        properties:
                          low_rare:
                            type: string
                            example: 0
                          low_unlikely:
                            type: string
                            example: 0
                          low_moderate:
                            type: string
                            example: 0
                          low_likely:
                            type: string
                            example: 0
                          low_almost_certain:
                            type: string
                            example: 0
                          medium_rare:
                            type: string
                            example: 0
                          medium_unlikely:
                            type: string
                            example: 0
                          medium_moderate:
                            type: string
                            example: 0
                          medium_likely:
                            type: string
                            example: 0
                          medium_almost_certain:
                            type: string
                            example: 0
                          high_rare:
                            type: string
                            example: 0
                          high_unlikely:
                            type: string
                            example: 0
                          high_moderate:
                            type: string
                            example: 0
                          high_likely:
                            type: string
                            example: 0
                          high_almost_certain:
                            type: string
                            example: 0
                          critical_rare:
                            type: string
                            example: 0
                          critcal_unlikely:
                            type: string
                            example: 0
                          critical_moderate:
                            type: string
                            example: 0
                          critical_likely:
                            type: string
                            example: 0
                          critical_almost_certain:
                            type: string
                            example: 0
                      scanHistory:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              example: 1
                            sdate:
                              type: string
                              example: 2021-01-02T01:30:00.000Z
                            status:
                              type: string
                              example: completed
                            low:
                              type: string
                              example: 34
                            medium:
                              type: string
                              example: 128
                            high:
                              type: string
                              example: 39
                            critical:
                              type: string
                              example: 9
                      projectAssignement:
                        type: object
                        properties:
                          owner:
                            type: array
                            items:
                              type: object
                              $ref: "#/components/schemas/remediation_project_details_create"
                          assignee:
                            type: array
                            items:
                              type: object
                              $ref: "#/components/schemas/remediation_project_details_create"
                      riskPerAsset:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              example: 4
                            low:
                              type: string
                              example: 4
                            medium:
                              type: string
                              example: 8
                            high:
                              type: string
                              example: 0
                            critical:
                              type: string
                              example: 0

      summary: Get the dashboard's charts
      security:
        - bearerAuth: []
  /dashboard/{cid}:
    get:
      tags:
        - 'Dashboard'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  global:
                    type: integer
                    example: 42
      summary: Get a single chart from the dashboard
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: cid
          schema:
            type: string
          required: true
          description: "Wanted chart's ID, ex : severitiesSummary, global, topVulnerabilities, likelihoods, scanHistory, projectAssignement, riskPerAsset"
  /dashview:
    get:
      tags:
        - 'Dashboard'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  dashboard:
                    type: array
                    items:
                      type: object
                      properties:
                        breakpoint:
                          type: string
                          example: lg
                        items:
                          type: array
                          items:
                            type: object
                            properties:
                              id:
                                type: integer
                                example: 10
                              ckey:
                                type: string
                                example: severitiesSummary
                              name:
                                type: string
                                example: severity-summary
                              prop:
                                type: string
                                example: severitiesSummary
                              userX:
                                type: integer
                                example: 4
                              userY:
                                type: integer
                                example: 0
                              visible:
                                type: boolean
                              defaultX:
                                type: integer
                                example: 0
                              defaultY:
                                type: integer
                                example: 0
                              userWidth:
                                type: string
                                format: nullable
                              userHeight:
                                type: string
                                format: nullable
                              defaultWidth:
                                type: integer
                                example: 4
                              defaultHeight:
                                type: integer
                                example: 3
                              breakpointWidth:
                                type: integer
                                example: 1200
      summary: Get dashviews
      security:
        - bearerAuth: []
  /dashview/{dashId}:
    post:
      tags:
        - 'Dashboard'
      responses:
        '200':
          description: OK
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                x:
                  type: number
                  example: 318.158
                y:
                  type: number
                  example: 302
                width:
                  type: integer
                  example: 120
                height:
                  type: integer
                  example: 189
                visible:
                  type: boolean
                  example: true
      summary: update a  dashview
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: dashId
          schema:
            type: integer
          required: true
          description: Numeric ID of the dashview
  /feared-events/{fearedEventId}:
    patch:
      tags:
        - 'Feared Events'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                severityId:
                  type: number
                  example: 1
      responses:
        '204':
          description: OK
      summary: Update Severity of a Feared Event
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: fearedEventId
          schema:
            type: integer
          required: true
          description: Numeric ID of the Feared Event to update
  /files/csv/process:
    get:
      tags:
        - 'File'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  isAuthorized:
                    type: boolean
                    example: true
      summary: Get processCSV
      security:
        - bearerAuth: []
  /files/{id}:
    get:
      tags:
        - 'File'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  isAuthorized:
                    type: boolean
                    example: false
                  fileData:
                    type: object
      summary: download a file
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
            example: bfc8add2-15f0-45be-8b47-68e50a568c99
          required: true
          description: Numeric ID of the file
  /files:
    post:
      tags:
        - 'File'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  uuid:
                    type: integer
                    example: 12
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                files:
                  type: string
                  format: binary

      summary: Upload a file
      security:
        - bearerAuth: []
  /groups:
    get:
      tags:
        - 'Group'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  groups:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          example: 4
                        name:
                          type: string
                          example: Cloud_USA
                        members:
                          type: array
                          items:
                            type: object
                            properties:
                              id:
                                type: string
                                example: d080ea8b-7957-4ad3-86ec-0959cf0a050b
                              firstName:
                                type: string
                                example: Jean
                              lastName:
                                type: string
                                example: Paul
                              email:
                                type: string
                                example: jp@x-rator.com
                  total:
                    type: integer
                    example: 6
      summary: Get groups
      security:
        - bearerAuth: []
    post:
      tags:
        - 'Group'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  example: Ronintel
                memberIds:
                  type: array
                  items:
                    type: string
                    example: 31f0bba9-205b-4956-9079-d269b504c416

      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    example: 3
      summary: Create a group
      security:
        - bearerAuth: []
  /groups/{id}:
    get:
      tags:
        - 'Group'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    example: 4
                  name:
                    type: string
                    example: Cloud_USA
                  members:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          example: d080ea8b-7957-4ad3-86ec-0959cf0a050b
                        first_name:
                          type: string
                          example: Marco
                        last_name:
                          type: string
                          example: Paulo
                        email:
                          type: string
                          example: mp@x-rator.com
      summary: Get a single group
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: Numeric ID of the group
    patch:
      tags:
        - 'Group'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                memberIds:
                  type: array
                  items:
                    type: string
                    example: 31f0bba9-205b-4956-9079-d269b504c416
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    example: 3
                  name:
                    type: string
                    example: France
                  members:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          example: a8dcd27b-31b5-46ff-9f68-fe23fe0f2c0c
                        firstName:
                          type: string
                          example: Clarisse
                        lastName:
                          type: string
                          example: Lannes
                        email:
                          type: string
                          example: cl@x-rator.com
      summary: Edit a single group
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: Numeric ID of the group
    delete:
      tags:
        - 'Group'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: SUCCESS
      summary: Delete a single group
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: Numeric ID of the group
  /projects/priorities:
    get:
      tags:
        - "Project Priorities"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          example: 0
                        name:
                          type: string
                          example: "low"
                        weight:
                          type: integer
                          example: 0
      summary: Get priorities
      security:
        - bearerAuth: []

  /projects/priorities/{id}:
    get:
      tags:
        - "Project Priorities"
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: Numeric ID of the priority
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: integer
                        example: 0
                      name:
                        type: string
                        example: "low"
                      weight:
                        type: integer
                        example: 0
      summary: Get a single priority
      security:
        - bearerAuth: []

  /probes:
    get:
      tags:
        - 'Probes'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          example: 0
                        name:
                          type: string
                          example: ScanServer
                        cdate:
                          type: string
                          example: 2022-04-04T14:09:02.208Z
                        type:
                          type: string
                          example: SERVER
                        status:
                          type: string
                          example: Down
                        address:
                          type: string
                          example:
                        mask:
                          type: string
                          example:
                        mac:
                          type: string
                          example:
                        info:
                          type: string
                          example:
                        exitIp:
                          type: string
                          example:
                        gw:
                          type: string
                          example: scanner.ab001.x-rator.lan
                        storeId:
                          type: string
                          format: nullable
      summary: Get probes
      security:
        - bearerAuth: []
  /probes/{id}:
    patch:
      tags:
        - "probes"
      responses:
        "204":
          description: No Content
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: Numeric ID of the probe to update
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  example: purpleProbe
        required: true
      summary: Update a probe
      security:
        - bearerAuth: []
  /relations:
    post:
      tags:
        - 'Relation'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                type:
                  type: string
                  example: CONNECTED_TO
                from_asset_id:
                  type: integer
                  example: 48
                to_asset_id:
                  type: integer
                  example: 49
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    example: 28
      summary: Create a relation
      security:
        - bearerAuth: []
  /relations/bulk:
    post:
      tags:
        - "Relation"
      requestBody:
        content:
          application/json:
            schema:
              type: array
              items:
                type: object
                properties:
                  relationType:
                    type: string
                    example: CONNECTED_TO
                  fromAssetId:
                    type: integer
                    example: 48
                  toAssetId:
                    type: integer
                    example: 49
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                  type: array
                  items:
                    type: object
                    properties:
                      id:
                        type: integer
                        example: 28
      summary: Create a relation
      security:
        - bearerAuth: []
  /relations/{relId}:
    patch:
      tags:
        - 'Relation'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                type:
                  type: string
                  example: CONNECTED_TO
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    example: 28
      summary: Edit a single relation
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: relId
          schema:
            type: integer
          required: true
          description: Numeric ID of the relation
    delete:
      tags:
        - 'Relation'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: 'SUCCESS'
      summary: Delete a single relation
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: relId
          schema:
            type: integer
          required: true
          description: Numeric ID of the relation
  /relations/{fromAssetId}/{relationType}/{toAssetId}:
    delete:
      tags:
        - "Relation"
      responses:
        "200":
          description: Deleted
          content:
            application/json:
              schema:
                type: object
                properties:
                  count:
                    type: integer
                    example: 1
      summary: Delete a single relation
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: fromAssetId
          schema:
            type: integer
          required: true
          description: Numeric ID of the asset
        - in: path
          name: relationType
          schema:
            type: string
          required: true
          description: Relation type
        - in: path
          name: toAssetId
          schema:
            type: integer
          required: true
          description: Numeric ID of the asset
  /remediations/grouped:
    get:
      tags:
        - "Remediations"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        cluster_id:
                          type: integer
                          example: 1
                        remediation:
                          type: string
                          example: "Remediation description"
                        count_vuln:
                          type: integer
                          example: 3
                        count_asset:
                          type: integer
                          example: 3
                        count_asset_vuln:
                          type: integer
                          example: 3
                        count_asset_vuln_unmanaged:
                          type: integer
                          example: 3
      summary: Get the remediations grouped by cluster ordered by most occuring
      security:
        - bearerAuth: []
  /remediation-projects:
    post:
      tags:
        - "Remediation Project"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    example: 1
      requestBody:
        content:
          application/json:
            schema:
              type: object
              $ref: "#/components/schemas/remediation_project_details_create"
      summary: Create a remediation project
      security:
        - bearerAuth: []
  /remediation-projects/summary:
    get: 
      tags: 
        - "Remediation Project"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  remediation_projects:
                    type: array
                    items:
                      $ref: "#/components/schemas/remediation_project_summary"
                  total:
                    type: integer
                    example: 5
      summary: Get all remediation projects
      security:
        - bearerAuth: []
  /remediation-projects/{id}:
    get: 
      tags: 
        - "Remediation Project"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  remediation_projects:
                    $ref: "#/components/schemas/remediation_project_details"
      summary: Get a specific remediation project by its id
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: integer
            example: 2
          required: true
          description: Numeric ID of the remediation project to get
    patch:
      tags: 
        - "Remediation Project"
      security:
        - bearerAuth: []
      responses:
        "204":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      status_history_id:
                        type: integer
                        example: 26
                  status:
                    type: string
                    example: SUCCESS
      parameters:
        - in: path
          name: id
          schema:
            type: number
            example: 5
          required: true
          description: Numeric ID of the project
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/remediation_project_details_edit"
  /remediation-projects/{id}/scope:
    get: 
      tags: 
        - "Remediation Project"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/remediation_project_scope"
      summary: Get the scope of a specific remediation project by its id
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: integer
            example: 2
          required: true
          description: Numeric ID of the remediation project
    patch:
      tags: 
        - "Remediation Project"
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
          required: true
          description: String ID of the remediation project
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/remediation_project_scope_edit"
      responses:
        "201":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: SUCCESS
                  data:
                    type: object
                    properties:
                      deleted:
                        type: number
                      inserted:
                        type: number
  /remediation-projects/{id}/scope/{scopeId}:
    patch:
      tags: 
        - "Remediation Project"
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: number
          required: true
          description: ID of the remediation project
        - in: path
          name: scopeId
          schema:
            type: number
          required: true
          description: ID of the remediation project scope item
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/remediation_project_scope_item_edit"
      responses:
        "204":
          description: OK 
  /remediation-projects/{id}/status-history:
    get: 
      tags: 
        - "Remediation Project"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/remediation_project_details_status_history"
      summary: Get the status history of a specific remediation project by its id
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id 
          schema:
            type: integer
          required: true
          description: Numeric ID of the current remediation project
  /reports:
    get:
      tags:
        - 'Reports'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  docx:
                    type: object
                    properties:
                      type:
                        type: string
                        example: Buffer
                      data:
                        type: array
                        items:
                          type: integer
                          format: int32
                          example: 80
      summary: Generate and download a docx file which contains all vulnerabilities.
      security:
        - bearerAuth: []
  /severities:
    get:
      tags:
        - 'Severity'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          example: 0
                        name:
                          type: string
                          example: C1
      summary: Get all severities
      security:
        - bearerAuth: []
  /scans:
    get:
      tags:
        - 'Scan'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  scans:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          example: 22
                        name:
                          type: string
                          example: Discovery & Vulnerability & Hardening scan on green probe
                        createdAt:
                          type: string
                          example: "2022-04-01T13:56:30.728Z"
                        startedAt:
                          type: string
                          format: nullable
                        completedAt:
                          type: string
                          format: nullable
                        cdate:
                          type: string
                          example: "2022-04-01T13:56:30.728Z"
                        sdate:
                          type: string
                          format: nullable
                        fdate:
                          type: string
                          format: nullable
                        stratDate:
                          type: string
                          format: nullable
                        endDate:
                          type: string
                          format: nullable
                        stratTime:
                          type: string
                          format: nullable
                        endTime:
                          type: string
                          format: nullable
                        status:
                          type: string
                          example: New
                        probeName:
                          type: string
                          example: GreenProbe
                        low:
                          type: integer
                          example: 0
                        medium:
                          type: integer
                          example: 0
                        high:
                          type: integer
                          example: 0
                        crit:
                          type: integer
                          example: 0
                        assets:
                          type: array
                          items:
                            type: object
                            properties:
                              id:
                                type: integer
                                example: 1
                              name:
                                type: string
                                example: Bob-pc
                              os:
                                type: string
                                example: "Windows 10"
                              hostname:
                                type: string
                                example: "PCIUATDB02"
                              ips:
                                type: array
                                items:
                                  type: string
                                  example: "10.255.1.13"
                              language:
                                type: string
                                example: "PHP"
                              url:
                                type: string
                                example: "https://www.x-rator.com"
                              mail:
                                type: string
                                example: "bob@x-rator.com"
                  total:
                    type: integer
                    example: 11
      summary: Get scans
      security:
        - bearerAuth: []
    post:
      tags:
        - 'Scan'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                type:
                  type: array
                  items:
                    type: string
                    example: nmap
                name:
                  type: string
                  example: toto
                hasInternal:
                  type: boolean
                startDate:
                  type: string
                  format: nullable
                endDate:
                  type: string
                  format: nullable
                startTime:
                  type: string
                  example: 03:13
                endTime:
                  type: string
                  example: 03:46
                scanParams:
                  type: object
                  properties:
                    assets:
                      type: array
                      items:
                        type: object
                        properties:
                          address:
                            type: string
                            example: 1.125.1.1
                    credentials:
                      type: array
                      items:
                        type: object
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: array
                    items:
                      type: integer
                      example: 23
      summary: Create a scan
      security:
        - bearerAuth: []
  /scans/{scanId}:
    patch:
      tags:
        - 'Scan'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                status:
                  type: string
                  example: ToPause
      responses:
        '200':
          description: OK
      summary: Edit a single scan
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: scanId
          schema:
            type: integer
          required: true
          description: Numeric ID of the scan
  /scans/{scanId}/report:
    get:
      tags:
        - "Scan"
      responses:
        "201":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  scan:
                    $ref: "#/components/schemas/scan"
                  scope:
                    type: array
                    items:
                      type: object
                      properties:
                        asset_id:
                          type: integer
                          example: 1
                        asset_name:
                          type: string
                          example: "10.20.20.10"
                        asset_type:
                          type: string
                          example: "SERVER"
                  vulnerabilities:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          example: 1
                        cve:
                          type: string
                          example: CVE-2021-23840, CVE-2021-23841
                        name:
                          type: string
                          example: "Debian LTS: Security Advisory for openssl (DLA-2563-1)"
                        description:
                          type: string
                        remediation:
                          type: string
                  scan_result_vulnerabilities:
                    type: array
                    items: 
                      type: object
                      properties:
                        scan_id:
                          type: integer
                          example: 1
                        vulnerability_id:
                          type: integer
                          example: 1
                        cve:
                          type: string
                          example: "CVE-2018-3615, CVE-2018-3646, CVE-2018-3620"
                        severity:
                          type: string
                          example: "low"
                        cvss_score:
                          type: number
                          example: 9,3
                        asset_id:
                          type: integer
                          example: 1
                        asset_name:
                          type: string
                          example: Paul-pc
                        asset_type:
                          type: string
                          example: SERVER
                        ip_address:
                          type: string
                          example: 10.254.0.2
                        port_number:
                          type: integer
                          example: 80
                        protocol:
                          type: string
                          example: tcp
                        uri:
                          type: string
                          example: /index.php
      summary: Get a scan vulnerability report for a specific scan
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: scanId
          schema:
            type: integer
          required: true
          description: Numeric ID of the scan for which to get the report
  /scans/{scanId}/report/download:
    get:
      tags:
        - 'Scan'
      responses:
        '200':
          description: OK
      summary: Edit a single scan
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: scanId
          schema:
            type: integer
          required: true
          description: Numeric ID of the scan
  /scans/result:
    post:
      tags:
        - 'Scan'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                hosts:
                  type: array
                  items:
                    type: object
                vulns:
                  type: array
                  items:
                    type: object
                scanType:
                  type: string
                  example: 'Scan'
                name:
                  type: string
                  example: 'Verify port openned'
                addToCy:
                  type: boolean
                cyId:
                  type: string
                  example: '10'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: SUCCESS
      summary: Create a result
      security:
        - bearerAuth: []
  /scans/assets:
    get:
      tags:
        - 'Scan'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  assets:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          example: "10"
                        address:
                          type: string
                          example: "1.0.01.0"
      summary: Get available assets
      security:
        - bearerAuth: []
  /scans/phishing-scenarios:
    get:
      tags:
        - 'Scan'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                      example: 12
                    name:
                      type: string
                      example: mail credit card
                    description:
                      type: string
                      example: 'False bank email asking for private data (ex: credit card number ...)'
                    severity:
                      type: integer
                      example: 4
      summary: Get phishing-scenarios
      security:
        - bearerAuth: []
  /compliance:
    get:
      tags:
        - 'Self-assessment'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  compliances:
                    type: array
                    items:
                      oneOf:
                        - $ref: "#/components/schemas/compliance_list"
                        - $ref: "#/components/schemas/compliance_details"
                  statistics:
                    type: array
                    items:
                      $ref: "#/components/schemas/compliance_stats"
      parameters:
        - in: query
          name: compliance
          schema:
            type: string
          required: false
          description: Name of the compliance to get
      summary: Get compliances or a specfic compliance details for a company
      security:
        - bearerAuth: []
  /tags:
    get:
      tags:
        - 'Tag'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  tags:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          example: 3
                        name:
                          type: string
                          example: Cloud
                        color:
                          type: string
                          example: '#0078D4'
                  total:
                    type: integer
                    example: 15
      summary: Get tags
      security:
        - bearerAuth: []
    post:
      tags:
        - 'Tag'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  example: tag1
                color:
                  type: string
                  example: '#0078D4'
        required: true
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    example: 2
      summary: Create a tag
      security:
        - bearerAuth: []
  /tags/{id}:
    get:
      tags:
        - 'Tag'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    example: 3
                  name:
                    type: string
                    example: Cloud
                  color:
                    type: string
                    example: '#0078D4'
      summary: Get a single tag
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: Numeric ID of the tag
    patch:
      tags:
        - "Tag"
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  example: tag1
                color:
                  type: string
                  example: '#0078D4'
        required: true
      responses:
        "201":
          description: OK
      summary: Create a tag
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: Numeric ID of the tag
    delete:
      tags:
        - 'Tag'
      responses:
        '204':
          description: No Content
      summary: Delete a single tag
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: Numeric ID of the tag
  /users:
    get:
      tags:
        - 'User'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  users:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          example: a8dcd27b-31b5-46ff-9f68-fe23fe0f2c0c
                        firstName:
                          type: string
                          example: Didier
                        lastName:
                          type: string
                          example: Brognard
                        email:
                          type: string
                          example: brobro@x-rator.com
                        roles:
                          type: array
                          items:
                            type: string
                            example: admin
                        groups:
                          type: array
                          items:
                            type: object
                            properties:
                              id:
                                type: integer
                                example: 1
                              name:
                                type: string
                                example: R&D
                  total:
                    type: integer
                    example: 3

      summary: Get users
      security:
        - bearerAuth: []
    post:
      tags:
        - 'User'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                firstName:
                  type: string
                  example: test
                lastName:
                  type: string
                  example: test
                username:
                  type: string
                  example: test
                email:
                  type: string
                  example: test@test.com
                password:
                  type: string
                  example: P@ssw0rd1234
                roles:
                  type: array
                  items:
                    type: string
                    example: member
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    example: ef89160d-1b0a-4078-948b-0759ddb2166b
      summary: Create a user
      security:
        - bearerAuth: []
  /users/{id}:
    get:
      tags:
        - 'User'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    example: a8dcd27b-31b5-46ff-9f68-fe23fe0f2c0c
                  username:
                    type: string
                    example: Doog
                  first_name:
                    type: string
                    example: Douglas
                  last_name:
                    type: string
                    example: dalahilama
                  email:
                    type: string
                    example: dd@x-rator.com
                  roles:
                    type: array
                    items:
                      type: string
                      example: admin
                  groups:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          example: 1
                        name:
                          type: string
                          example: SSI
      summary: Get a single user
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
            example: a8dcd27b-31b5-46ff-9f68-fe23fe0f2c0c
          required: true
          description: Numeric ID of the user
    patch:
      tags:
        - 'User'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                roles:
                  type: array
                  items:
                    type: string
                    example: admin
                groupIds:
                  type: array
                  items:
                    type: integer
                    example: 2
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    example: a8dcd27b-31b5-46ff-9f68-fe23fe0f2c0c
                  username:
                    type: string
                    example: bg
                  first_name:
                    type: string
                    example: Bob
                  last_name:
                    type: string
                    example: Gauss
                  email:
                    type: string
                    example: bg@x-rator.com
                  roles:
                    type: array
                    items:
                      type: string
                      example: admin
                  groups:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          example: 2
                        name:
                          type: string
                          example: XRATOR
      summary: Edit a single user
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
            example: a8dcd27b-31b5-46ff-9f68-fe23fe0f2c0c
          required: true
          description: Numeric ID of the user
    delete:
      tags:
        - 'User'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: SUCCESS
      summary: Delete a single user
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
            example: a8dcd27b-31b5-46ff-9f68-fe23fe0f2c0c
          required: true
          description: Numeric ID of the user
  /vulnerabilities:
    get:
      tags:
        - 'Vulnerability'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  vulnerabilities:
                    type: array
                    items:
                      $ref: "#/components/schemas/vulnerability"
                  total:
                    type: integer
                    example: 10
      summary: Get vulnerabilities
      security:
        - bearerAuth: []
    post:
      tags:
        - 'Vulnerability'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    example: 1
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  example: vuln1
                description:
                  type: string
                  example: <h3>Description&nbsp;</h3>
                remediation:
                  type: string
                  example: <h3>Remediation</h3>
                urls:
                  type: array
                  items:
                    type: string
                    example: http://re001.x-rator.lan:3000/
                cves:
                  type: array
                  items:
                    type: string
                    example: CVE-2022-1000
      summary: Create a vulnerability
      security:
        - bearerAuth: []
  /vulnerabilities/assets:
    get:
      tags:
        - "Vulnerability"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  vulnerabilities:
                    type: array
                    items:
                      $ref: "#/components/schemas/vulnerability"
                  total:
                    type: integer
                    example: 10
      summary: Get vulnerabilities with their affected assets
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: search
          schema:
            type: string
            example: Adobe Flash Player
          description: The string to search in the vulnerabilities names
        - in: query
          name: severities
          schema:
            type: array
          description: The severities of the assets vulnerabilities to filter
        - in: query
          name: likelihoods
          schema:
            type: array
          description: The likelihoods of the assets vulnerabilities to filter
        - in: query
          name: assets_ids
          schema:
            type: string
            example: "8,9"
          description: The IDs of the affected assets to filter
        - in: query
          name: clusters_ids
          schema:
            type: string
            example: "8,9"
          description: The IDs of the clusters to filter
        - in: query
          name: page
          schema:
            type: number
            example: 2
          description: The number of the page to Get
        - in: query
          name: page_size
          schema:
            type: number
            example: 10
          description: The number of items per page to Get
  /vulnerabilities/{vid}:
    get:
      tags:
        - 'Vulnerability'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/vulnerability"
      summary: Get a single vulnerability
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: vid
          schema:
            type: integer
          required: true
          description: Numeric ID of the vulnerability
  /vulnerabilities/{vid}/assets:
    get:
      tags:
        - "Vulnerability"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/vulnerability"
      summary: Get a single vulnerability with its affected assets
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: vid
          schema:
            type: integer
            example: 1
          required: true
          description: Numeric ID of the vulnerability
        - in: query
          name: search
          schema:
            type: string
            example: Adobe Flash Player
          description: The string to search in the vulnerabilities names
        - in: query
          name: severities
          schema:
            type: array
          description: The severities of the assets vulnerabilities to filter
        - in: query
          name: likelihoods
          schema:
            type: array
          description: The likelihoods of the assets vulnerabilities to filter
  /ips/{ipId}:
    delete:
      tags:
        - 'Ips'
      description: ''
      summary: Delete a single ip
      security:
        - bearerAuth: []
      responses:
        '204':
          description: No Content
      parameters:
        - in: path
          name: ipId
          schema:
            type: integer
          required: true
          description: Numeric ID of the ip to delete
  /ips/{ipToUpdate}:
    patch:
      tags:
        - 'Ips'
      responses:
        '204':
          description: Ok
          content:
            properties:
              example: Changement effectués
      parameters:
        - in: path
          name: ipToUpdate
          schema:
            type: integer
          required: true
          description: Numeric ID of the ip to update
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                address:
                  type: string
                  example: 10.254.1.1
                mac:
                  type: string
                  format: nullable
                iface:
                  type: string
                  format: nullable
                mask:
                  type: string
                  format: nullable
        required: true
      summary: Update an ip
      security:
        - bearerAuth: []
  /ips/{assetId}:
    post:
      tags:
        - "Ips"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  ipId:
                    type: integer
                    example: 35
      parameters:
        - in: path
          name: assetId
          schema:
            type: integer
          required: true
          description: Numeric ID of the asset link to the ip
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                address:
                  type: string
                  example: 10.254.1.1
                mac:
                  type: string
                  format: nullable
                iface:
                  type: string
                  format: nullable
                mask:
                  type: string
                  format: nullable
        required: true
      summary: Create an ip and associate it with a given asset
      security:
        - bearerAuth: []
  /phishing-scenarios-domains:
    get:
      tags:
        - 'Phishing scenarios domains'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                      example: 12
                    name:
                      type: string
                      example: xrtr.cc
      summary: Get phishing-scenarios-domains
      security:
        - bearerAuth: []
